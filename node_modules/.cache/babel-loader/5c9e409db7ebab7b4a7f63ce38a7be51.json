{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useActiveWeb3React } from 'hooks';\nimport { useFetchDualFarmListCallback } from 'hooks/useFetchDualFarmListCallback';\nimport useInterval from 'hooks/useInterval';\nimport useIsWindowVisible from 'hooks/useIsWindowVisible';\nimport { acceptDualFarmUpdate } from './actions';\nexport default function Updater() {\n  _s();\n\n  const {\n    library\n  } = useActiveWeb3React();\n  const dispatch = useDispatch();\n  const dualFarms = useSelector(state => state.dualFarms.byUrl);\n  const isWindowVisible = useIsWindowVisible();\n  const fetchDualFarmList = useFetchDualFarmListCallback();\n  const fetchAllListsCallback = useCallback(() => {\n    if (!isWindowVisible) return;\n    Object.keys(dualFarms).forEach(url => fetchDualFarmList(url).catch(error => console.debug('interval list fetching error', error)));\n  }, [fetchDualFarmList, isWindowVisible, dualFarms]); // fetch all lists every 10 minutes, but only after we initialize library\n\n  useInterval(fetchAllListsCallback, library ? 1000 * 60 * 10 : null); // whenever a list is not loaded and not loading, try again to load it\n\n  useEffect(() => {\n    Object.keys(dualFarms).forEach(listUrl => {\n      const farm = dualFarms[listUrl];\n\n      if (!farm.current && !farm.loadingRequestId && !farm.error) {\n        fetchDualFarmList(listUrl).catch(error => console.debug('list added fetching error', error));\n      }\n    });\n  }, [dispatch, fetchDualFarmList, library, dualFarms]); // automatically update lists if versions are minor/patch\n\n  useEffect(() => {\n    Object.keys(dualFarms).forEach(listUrl => {\n      const farm = dualFarms[listUrl];\n\n      if (farm.current && farm.pendingUpdate) {\n        //Auto update farms until we create the versioning infrastructure that the tokens list has\n        dispatch(acceptDualFarmUpdate(listUrl));\n      }\n    });\n  }, [dispatch, dualFarms]);\n  return null;\n}\n\n_s(Updater, \"fSnVlQKKydNZi7u1IFuowfXxRNg=\", false, function () {\n  return [useActiveWeb3React, useDispatch, useSelector, useIsWindowVisible, useFetchDualFarmListCallback, useInterval];\n});\n\n_c = Updater;\n\nvar _c;\n\n$RefreshReg$(_c, \"Updater\");","map":{"version":3,"sources":["/Users/danielmaina/Downloads/_newCrptProj/clientBase/DEX/interface-v2-master/src/state/dualfarms/updater.ts"],"names":["useCallback","useEffect","useDispatch","useSelector","useActiveWeb3React","useFetchDualFarmListCallback","useInterval","useIsWindowVisible","acceptDualFarmUpdate","Updater","library","dispatch","dualFarms","state","byUrl","isWindowVisible","fetchDualFarmList","fetchAllListsCallback","Object","keys","forEach","url","catch","error","console","debug","listUrl","farm","current","loadingRequestId","pendingUpdate"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,SAAtB,QAAuC,OAAvC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,kBAAT,QAAmC,OAAnC;AACA,SAASC,4BAAT,QAA6C,oCAA7C;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAOC,kBAAP,MAA+B,0BAA/B;AAEA,SAASC,oBAAT,QAAqC,WAArC;AAEA,eAAe,SAASC,OAAT,GAAyB;AAAA;;AACtC,QAAM;AAAEC,IAAAA;AAAF,MAAcN,kBAAkB,EAAtC;AACA,QAAMO,QAAQ,GAAGT,WAAW,EAA5B;AACA,QAAMU,SAAS,GAAGT,WAAW,CAC1BU,KAAD,IAAWA,KAAK,CAACD,SAAN,CAAgBE,KADA,CAA7B;AAIA,QAAMC,eAAe,GAAGR,kBAAkB,EAA1C;AAEA,QAAMS,iBAAiB,GAAGX,4BAA4B,EAAtD;AACA,QAAMY,qBAAqB,GAAGjB,WAAW,CAAC,MAAM;AAC9C,QAAI,CAACe,eAAL,EAAsB;AACtBG,IAAAA,MAAM,CAACC,IAAP,CAAYP,SAAZ,EAAuBQ,OAAvB,CAAgCC,GAAD,IAC7BL,iBAAiB,CAACK,GAAD,CAAjB,CAAuBC,KAAvB,CAA8BC,KAAD,IAC3BC,OAAO,CAACC,KAAR,CAAc,8BAAd,EAA8CF,KAA9C,CADF,CADF;AAKD,GAPwC,EAOtC,CAACP,iBAAD,EAAoBD,eAApB,EAAqCH,SAArC,CAPsC,CAAzC,CAVsC,CAmBtC;;AACAN,EAAAA,WAAW,CAACW,qBAAD,EAAwBP,OAAO,GAAG,OAAO,EAAP,GAAY,EAAf,GAAoB,IAAnD,CAAX,CApBsC,CAsBtC;;AACAT,EAAAA,SAAS,CAAC,MAAM;AACdiB,IAAAA,MAAM,CAACC,IAAP,CAAYP,SAAZ,EAAuBQ,OAAvB,CAAgCM,OAAD,IAAa;AAC1C,YAAMC,IAAI,GAAGf,SAAS,CAACc,OAAD,CAAtB;;AAEA,UAAI,CAACC,IAAI,CAACC,OAAN,IAAiB,CAACD,IAAI,CAACE,gBAAvB,IAA2C,CAACF,IAAI,CAACJ,KAArD,EAA4D;AAC1DP,QAAAA,iBAAiB,CAACU,OAAD,CAAjB,CAA2BJ,KAA3B,CAAkCC,KAAD,IAC/BC,OAAO,CAACC,KAAR,CAAc,2BAAd,EAA2CF,KAA3C,CADF;AAGD;AACF,KARD;AASD,GAVQ,EAUN,CAACZ,QAAD,EAAWK,iBAAX,EAA8BN,OAA9B,EAAuCE,SAAvC,CAVM,CAAT,CAvBsC,CAmCtC;;AACAX,EAAAA,SAAS,CAAC,MAAM;AACdiB,IAAAA,MAAM,CAACC,IAAP,CAAYP,SAAZ,EAAuBQ,OAAvB,CAAgCM,OAAD,IAAa;AAC1C,YAAMC,IAAI,GAAGf,SAAS,CAACc,OAAD,CAAtB;;AACA,UAAIC,IAAI,CAACC,OAAL,IAAgBD,IAAI,CAACG,aAAzB,EAAwC;AACtC;AACAnB,QAAAA,QAAQ,CAACH,oBAAoB,CAACkB,OAAD,CAArB,CAAR;AACD;AACF,KAND;AAOD,GARQ,EAQN,CAACf,QAAD,EAAWC,SAAX,CARM,CAAT;AAUA,SAAO,IAAP;AACD;;GA/CuBH,O;UACFL,kB,EACHF,W,EACCC,W,EAIMI,kB,EAEEF,4B,EAW1BC,W;;;KApBsBG,O","sourcesContent":["import { useCallback, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useActiveWeb3React } from 'hooks';\nimport { useFetchDualFarmListCallback } from 'hooks/useFetchDualFarmListCallback';\nimport useInterval from 'hooks/useInterval';\nimport useIsWindowVisible from 'hooks/useIsWindowVisible';\nimport { AppDispatch, AppState } from 'state';\nimport { acceptDualFarmUpdate } from './actions';\n\nexport default function Updater(): null {\n  const { library } = useActiveWeb3React();\n  const dispatch = useDispatch<AppDispatch>();\n  const dualFarms = useSelector<AppState, AppState['dualFarms']['byUrl']>(\n    (state) => state.dualFarms.byUrl,\n  );\n\n  const isWindowVisible = useIsWindowVisible();\n\n  const fetchDualFarmList = useFetchDualFarmListCallback();\n  const fetchAllListsCallback = useCallback(() => {\n    if (!isWindowVisible) return;\n    Object.keys(dualFarms).forEach((url) =>\n      fetchDualFarmList(url).catch((error) =>\n        console.debug('interval list fetching error', error),\n      ),\n    );\n  }, [fetchDualFarmList, isWindowVisible, dualFarms]);\n\n  // fetch all lists every 10 minutes, but only after we initialize library\n  useInterval(fetchAllListsCallback, library ? 1000 * 60 * 10 : null);\n\n  // whenever a list is not loaded and not loading, try again to load it\n  useEffect(() => {\n    Object.keys(dualFarms).forEach((listUrl) => {\n      const farm = dualFarms[listUrl];\n\n      if (!farm.current && !farm.loadingRequestId && !farm.error) {\n        fetchDualFarmList(listUrl).catch((error) =>\n          console.debug('list added fetching error', error),\n        );\n      }\n    });\n  }, [dispatch, fetchDualFarmList, library, dualFarms]);\n\n  // automatically update lists if versions are minor/patch\n  useEffect(() => {\n    Object.keys(dualFarms).forEach((listUrl) => {\n      const farm = dualFarms[listUrl];\n      if (farm.current && farm.pendingUpdate) {\n        //Auto update farms until we create the versioning infrastructure that the tokens list has\n        dispatch(acceptDualFarmUpdate(listUrl));\n      }\n    });\n  }, [dispatch, dualFarms]);\n\n  return null;\n}\n"]},"metadata":{},"sourceType":"module"}