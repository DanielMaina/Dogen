{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar BuildTransactionRequest_1 = require(\"../models/transaction/build/BuildTransactionRequest\");\n\nvar BuildSimpleTransactionRequest_1 = require(\"../models/transaction/build/BuildSimpleTransactionRequest\");\n\nvar BuildTokenTransferRequest_1 = require(\"../models/transaction/build/BuildTokenTransferRequest\");\n\nvar BuildNftTransferRequest_1 = require(\"../models/transaction/build/BuildNftTransferRequest\");\n\nvar BuildGasTransferRequest_1 = require(\"../models/transaction/build/BuildGasTransferRequest\");\n\nvar BuildContractExecutionRequest_1 = require(\"../models/transaction/build/BuildContractExecutionRequest\");\n\nvar Popup_1 = tslib_1.__importDefault(require(\"../popup/Popup\"));\n\nvar EventTypes_1 = require(\"../types/EventTypes\");\n\nvar Utils_1 = tslib_1.__importDefault(require(\"../utils/Utils\"));\n\nvar BuildMessageSignRequest_1 = require(\"../models/transaction/build/BuildMessageSignRequest\");\n\nvar BuildEip712SignRequest_1 = require(\"../models/transaction/build/BuildEip712SignRequest\");\n\nvar PopupSigner =\n/** @class */\nfunction () {\n  function PopupSigner(bearerTokenProvider, options) {\n    var _this = this;\n\n    this.bearerTokenProvider = bearerTokenProvider;\n    this.popup = new PopupSignerPopup(Utils_1.default.urls.connect + \"/popup/transaction/init.html\", this.bearerTokenProvider, options);\n    window.addEventListener('beforeunload', function () {\n      _this.closePopup();\n    });\n  }\n\n  PopupSigner.prototype.closePopup = function () {\n    this.popup.close();\n  };\n\n  PopupSigner.prototype.isOpen = function () {\n    return this.popup.isOpen();\n  };\n\n  PopupSigner.prototype.sign = function (signatureRequest) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        signatureRequest.hash = typeof signatureRequest.hash === 'undefined' ? true : signatureRequest.hash;\n        signatureRequest.prefix = typeof signatureRequest.hash === 'undefined' ? true : signatureRequest.prefix;\n        return [2\n        /*return*/\n        , this.signRequest(signatureRequest)];\n      });\n    });\n  };\n\n  PopupSigner.prototype.signMessage = function (buildDate) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.signRequest(BuildMessageSignRequest_1.BuildMessageSignRequest.fromData(buildDate))];\n      });\n    });\n  };\n\n  PopupSigner.prototype.signEip712 = function (buildDate) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.signRequest(BuildEip712SignRequest_1.BuildEip712SignRequest.fromData(buildDate))];\n      });\n    });\n  };\n  /** Deprecated since 1.1.9. Use sign instead */\n\n\n  PopupSigner.prototype.signTransaction = function (signatureRequest) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.sign(signatureRequest)];\n      });\n    });\n  };\n\n  PopupSigner.prototype.executeNativeTransaction = function (transactionRequest) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.execute(transactionRequest)];\n      });\n    });\n  };\n  /** Deprecated since 1.4.0. Use transfer functions instead */\n\n\n  PopupSigner.prototype.executeTransaction = function (genericTransactionRequestOrTransactionId) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        if (typeof genericTransactionRequestOrTransactionId === 'string') {\n          return [2\n          /*return*/\n          , this.execute({\n            transactionId: genericTransactionRequestOrTransactionId\n          })];\n        } else {\n          return [2\n          /*return*/\n          , this.execute(BuildTransactionRequest_1.BuildTransactionRequest.fromData(genericTransactionRequestOrTransactionId))];\n        }\n\n        return [2\n        /*return*/\n        ];\n      });\n    });\n  };\n\n  PopupSigner.prototype.executeTransfer = function (buildTransactionData) {\n    return this.execute(BuildSimpleTransactionRequest_1.BuildSimpleTransactionRequest.fromData(buildTransactionData));\n  };\n\n  PopupSigner.prototype.executeTokenTransfer = function (buildTransactionData) {\n    return this.execute(BuildTokenTransferRequest_1.BuildTokenTransferRequest.fromData(buildTransactionData));\n  };\n\n  PopupSigner.prototype.executeNftTransfer = function (buildTransactionData) {\n    return this.execute(BuildNftTransferRequest_1.BuildNftTransferRequest.fromData(buildTransactionData));\n  };\n\n  PopupSigner.prototype.executeGasTransfer = function (buildTransactionData) {\n    return this.execute(BuildGasTransferRequest_1.BuildGasTransferRequest.fromData(buildTransactionData));\n  };\n\n  PopupSigner.prototype.executeContract = function (buildTransactionData) {\n    return this.execute(BuildContractExecutionRequest_1.BuildContractExecutionRequest.fromData(buildTransactionData));\n  };\n\n  PopupSigner.prototype.executeSavedTransaction = function (transactionId) {\n    return this.handleRequest(\"execute/\" + transactionId, {});\n  };\n\n  PopupSigner.prototype.resubmitTransaction = function (transactionId) {\n    return this.handleRequest('resubmit', {\n      transactionId: transactionId\n    });\n  };\n\n  PopupSigner.prototype.cancelTransaction = function (transactionId) {\n    return this.handleRequest('cancel', {\n      transactionId: transactionId\n    });\n  };\n\n  PopupSigner.prototype.confirm = function (request) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.handleRequest('confirm', request)];\n      });\n    });\n  };\n\n  PopupSigner.prototype.execute = function (requestData) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.handleRequest('execute', requestData)];\n      });\n    });\n  };\n\n  PopupSigner.prototype.signRequest = function (requestData) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        return [2\n        /*return*/\n        , this.handleRequest('sign', requestData)];\n      });\n    });\n  };\n\n  PopupSigner.prototype.handleRequest = function (action, requestData) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return tslib_1.__generator(this, function (_a) {\n        this.popup.focus();\n        return [2\n        /*return*/\n        , this.popup.sendData(action, Object.assign({}, requestData)).finally(function () {\n          _this.closePopup();\n        })];\n      });\n    });\n  };\n\n  return PopupSigner;\n}();\n\nexports.PopupSigner = PopupSigner;\n\nvar PopupSignerPopup =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(PopupSignerPopup, _super);\n\n  function PopupSignerPopup(url, bearerTokenProvider, options) {\n    var _this = _super.call(this, url, bearerTokenProvider, options) || this;\n\n    _this.finishedEventType = EventTypes_1.EventTypes.SIGNER_FINISHED;\n    _this.sendDataEventType = EventTypes_1.EventTypes.SEND_TRANSACTION_DATA;\n    return _this;\n  }\n\n  PopupSignerPopup.prototype.sendData = function (action, requestData) {\n    var _this = this;\n\n    return new Promise(function (resolve, reject) {\n      _this.onPopupMountedQueue.push(_this.attachFinishedListener(resolve, reject));\n\n      _this.onPopupMountedQueue.push(_this.sendDataToPopup(action, requestData));\n\n      _this.processPopupMountedQueue();\n    });\n  };\n\n  PopupSignerPopup.prototype.sendDataToPopup = function (action, requestData) {\n    var _this = this;\n\n    return function () {\n      if (_this.isOpen()) {\n        _this.popupWindow.postMessage({\n          type: _this.sendDataEventType,\n          params: {\n            action: action,\n            transactionRequest: requestData,\n            bearerToken: _this.bearerTokenProvider()\n          }\n        }, Utils_1.default.urls.connect);\n      }\n    };\n  };\n\n  return PopupSignerPopup;\n}(Popup_1.default);","map":{"version":3,"sources":["../../../src/signer/PopupSigner.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar BuildTransactionRequest_1 = require(\"../models/transaction/build/BuildTransactionRequest\");\nvar BuildSimpleTransactionRequest_1 = require(\"../models/transaction/build/BuildSimpleTransactionRequest\");\nvar BuildTokenTransferRequest_1 = require(\"../models/transaction/build/BuildTokenTransferRequest\");\nvar BuildNftTransferRequest_1 = require(\"../models/transaction/build/BuildNftTransferRequest\");\nvar BuildGasTransferRequest_1 = require(\"../models/transaction/build/BuildGasTransferRequest\");\nvar BuildContractExecutionRequest_1 = require(\"../models/transaction/build/BuildContractExecutionRequest\");\nvar Popup_1 = tslib_1.__importDefault(require(\"../popup/Popup\"));\nvar EventTypes_1 = require(\"../types/EventTypes\");\nvar Utils_1 = tslib_1.__importDefault(require(\"../utils/Utils\"));\nvar BuildMessageSignRequest_1 = require(\"../models/transaction/build/BuildMessageSignRequest\");\nvar BuildEip712SignRequest_1 = require(\"../models/transaction/build/BuildEip712SignRequest\");\nvar PopupSigner = /** @class */ (function () {\n    function PopupSigner(bearerTokenProvider, options) {\n        var _this = this;\n        this.bearerTokenProvider = bearerTokenProvider;\n        this.popup = new PopupSignerPopup(Utils_1.default.urls.connect + \"/popup/transaction/init.html\", this.bearerTokenProvider, options);\n        window.addEventListener('beforeunload', function () {\n            _this.closePopup();\n        });\n    }\n    PopupSigner.prototype.closePopup = function () {\n        this.popup.close();\n    };\n    PopupSigner.prototype.isOpen = function () {\n        return this.popup.isOpen();\n    };\n    PopupSigner.prototype.sign = function (signatureRequest) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                signatureRequest.hash = typeof signatureRequest.hash === 'undefined' ? true : signatureRequest.hash;\n                signatureRequest.prefix = typeof signatureRequest.hash === 'undefined' ? true : signatureRequest.prefix;\n                return [2 /*return*/, this.signRequest(signatureRequest)];\n            });\n        });\n    };\n    PopupSigner.prototype.signMessage = function (buildDate) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.signRequest(BuildMessageSignRequest_1.BuildMessageSignRequest.fromData(buildDate))];\n            });\n        });\n    };\n    PopupSigner.prototype.signEip712 = function (buildDate) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.signRequest(BuildEip712SignRequest_1.BuildEip712SignRequest.fromData(buildDate))];\n            });\n        });\n    };\n    /** Deprecated since 1.1.9. Use sign instead */\n    PopupSigner.prototype.signTransaction = function (signatureRequest) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.sign(signatureRequest)];\n            });\n        });\n    };\n    PopupSigner.prototype.executeNativeTransaction = function (transactionRequest) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.execute(transactionRequest)];\n            });\n        });\n    };\n    /** Deprecated since 1.4.0. Use transfer functions instead */\n    PopupSigner.prototype.executeTransaction = function (genericTransactionRequestOrTransactionId) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                if (typeof genericTransactionRequestOrTransactionId === 'string') {\n                    return [2 /*return*/, this.execute({ transactionId: genericTransactionRequestOrTransactionId })];\n                }\n                else {\n                    return [2 /*return*/, this.execute(BuildTransactionRequest_1.BuildTransactionRequest.fromData(genericTransactionRequestOrTransactionId))];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    PopupSigner.prototype.executeTransfer = function (buildTransactionData) {\n        return this.execute(BuildSimpleTransactionRequest_1.BuildSimpleTransactionRequest.fromData(buildTransactionData));\n    };\n    PopupSigner.prototype.executeTokenTransfer = function (buildTransactionData) {\n        return this.execute(BuildTokenTransferRequest_1.BuildTokenTransferRequest.fromData(buildTransactionData));\n    };\n    PopupSigner.prototype.executeNftTransfer = function (buildTransactionData) {\n        return this.execute(BuildNftTransferRequest_1.BuildNftTransferRequest.fromData(buildTransactionData));\n    };\n    PopupSigner.prototype.executeGasTransfer = function (buildTransactionData) {\n        return this.execute(BuildGasTransferRequest_1.BuildGasTransferRequest.fromData(buildTransactionData));\n    };\n    PopupSigner.prototype.executeContract = function (buildTransactionData) {\n        return this.execute(BuildContractExecutionRequest_1.BuildContractExecutionRequest.fromData(buildTransactionData));\n    };\n    PopupSigner.prototype.executeSavedTransaction = function (transactionId) {\n        return this.handleRequest(\"execute/\" + transactionId, {});\n    };\n    PopupSigner.prototype.resubmitTransaction = function (transactionId) {\n        return this.handleRequest('resubmit', { transactionId: transactionId });\n    };\n    PopupSigner.prototype.cancelTransaction = function (transactionId) {\n        return this.handleRequest('cancel', { transactionId: transactionId });\n    };\n    PopupSigner.prototype.confirm = function (request) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.handleRequest('confirm', request)];\n            });\n        });\n    };\n    PopupSigner.prototype.execute = function (requestData) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.handleRequest('execute', requestData)];\n            });\n        });\n    };\n    PopupSigner.prototype.signRequest = function (requestData) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                return [2 /*return*/, this.handleRequest('sign', requestData)];\n            });\n        });\n    };\n    PopupSigner.prototype.handleRequest = function (action, requestData) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                this.popup.focus();\n                return [2 /*return*/, this.popup\n                        .sendData(action, Object.assign({}, requestData))\n                        .finally(function () {\n                        _this.closePopup();\n                    })];\n            });\n        });\n    };\n    return PopupSigner;\n}());\nexports.PopupSigner = PopupSigner;\nvar PopupSignerPopup = /** @class */ (function (_super) {\n    tslib_1.__extends(PopupSignerPopup, _super);\n    function PopupSignerPopup(url, bearerTokenProvider, options) {\n        var _this = _super.call(this, url, bearerTokenProvider, options) || this;\n        _this.finishedEventType = EventTypes_1.EventTypes.SIGNER_FINISHED;\n        _this.sendDataEventType = EventTypes_1.EventTypes.SEND_TRANSACTION_DATA;\n        return _this;\n    }\n    PopupSignerPopup.prototype.sendData = function (action, requestData) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.onPopupMountedQueue.push(_this.attachFinishedListener(resolve, reject));\n            _this.onPopupMountedQueue.push(_this.sendDataToPopup(action, requestData));\n            _this.processPopupMountedQueue();\n        });\n    };\n    PopupSignerPopup.prototype.sendDataToPopup = function (action, requestData) {\n        var _this = this;\n        return function () {\n            if (_this.isOpen()) {\n                _this.popupWindow.postMessage({ type: _this.sendDataEventType, params: { action: action, transactionRequest: requestData, bearerToken: _this.bearerTokenProvider() } }, Utils_1.default.urls.connect);\n            }\n        };\n    };\n    return PopupSignerPopup;\n}(Popup_1.default));\n//# sourceMappingURL=PopupSigner.js.map"]},"metadata":{},"sourceType":"script"}